# 연구노트 (책임자 관점)

- **날짜**: 2024-10-14
- **작성자**: 강혜림
- **역할**: 책임연구원
- **진행 단계**: 1단계 기초연구·설계
- **아젠다**: 출력 모듈·품질(QC) 체크리스트·자동화 파이프라인 설계

---

## 1. 연구 배경·목적 정리 (책임 관점)

- 오늘은 STT/TTS/RVC/Wav2Lip 등 개별 모듈의 결과를 **최종 산출물(영상·자막·음성)로 묶고, 이를 품질 기준에 따라 자동 검증하는 "출력·QC 파이프라인"** 을 설계하는 날이었다.
- IRIS 최종보고서에서 요구하는 정량 지표(립싱 오차, 화자 유사도, 자막 정합도 등)를 실제 수치로 만들어내는 곳이 바로 이 계층이기 때문에, 책임자 관점에서 **평가 가능성·재현성·리허설 준비도** 를 모두 고려해야 한다.

---

## 2. 오늘 진행 내용 (세부)

### 2.1 출력 파이프라인 설계
- FFmpeg 기반 렌더 파이프라인을 정의하고, 4K/60fps까지 대응할 수 있도록 NVENC 하드웨어 인코딩을 포함하는 구조로 설계.
- 반복 렌더링 시 불필요한 인코딩을 줄이기 위해, 중간 결과(예: 중간 영상, 중간 오디오)를 캐시하는 구조를 도입하여 약 35% 렌더링 시간을 절감할 수 있는 여지를 마련.

### 2.2 QC 체크리스트 정의
- 립싱 오차: ±80ms 이내
- 화자 유사도: cosine similarity 0.85 이상
- 자막 타임코드 오차: ±50ms 이내
- 배경 잡음 레벨: -45dB 이하 등 18개 항목으로 품질 기준을 정의.
- 각 항목에 대해 **측정 방법, 허용 범위, 실패 시 대응 방안**까지 문서에 포함.

### 2.3 자동 QC 스크립트 설계
- `render_pipeline.py`에 QC 모듈을 통합하는 구조를 설계.
  - AI 결과물 vs 기준(원본) 비교
  - 결과를 JSON 리포트로 출력하도록 설계
- 립싱 검증에는 Wav2Lip discriminative 네트워크 출력을 활용하고, 화자 유사도는 speaker embedding cosine similarity로 계산.

### 2.4 UI 연동
- Streamlit 콘솔에서 QC 결과를 heatmap, timeline chart 등 시각적 요소로 확인할 수 있도록 컴포넌트 구조를 논의.
- IRIS 리허설·최종보고 준비 시, **비전문가도 한눈에 품질 상태를 이해할 수 있는 뷰** 를 제공하는 것을 목표로 잡았다.

---

## 3. 책임자 관점 의사결정·리스크

- **결정 1: 품질 기준 강도**
  - 립싱 오차 ±80ms, 자막 ±50ms 등은 다소 타이트한 기준이지만, 최종보고서에서 차별화 포인트로 삼을 수 있다고 판단하여 유지.

- **결정 2: QC 결과의 JSON 표준화**
  - QC JSON 스키마를 고정해 두고, 이후 리포트/콘솔/IRIS 문서에서 모두 이 구조를 재사용하기로 함.

- **리스크 1: 고용량 영상 처리 병목**
  - 10GB 이상 대용량 영상에서 렌더링 병목이 발생할 수 있음이 확인됨.
  - → **대응**: chunked processing 및 병렬 렌더링을 10/21까지 추가로 설계·구현하기로 결정.

- **리스크 2: QC 결과 해석 난이도**
  - 수많은 수치와 지표가 생성되기 때문에, 사용자(평가자)가 이를 직관적으로 이해하지 못할 위험.
  - → **대응**: 콘솔 UI 수준에서 "합/불" 기준, 경고 색상, 간단한 설명 텍스트를 함께 제공하는 UX 개선을 10/22 릴리스에 포함.

---

## 4. 지표·산출물 정리

- **시스템 설계 산출물**
  - 출력 파이프라인 아키텍처 다이어그램 2장.
  - QC 체크리스트 18항목 정의 문서.
- **코드 산출물(초안)**
  - `render_pipeline.py`에 QC 모듈 통합을 위한 구조 초안.

---

## 5. 다음 액션 (책임 관점 To-do)

1. **10/15 ~ 10/18**
   - 10/15 자막 스트레스 테스트 결과와 연계해 QC 체크리스트의 임계값이 현실적인지 검증.
   - 10/18 orchestrator 통합 테스트에서 QC JSON 리포트가 end-to-end로 잘 생성되는지 확인.

2. **10/21 이후**
   - chunked processing 및 병렬 렌더링 도입 후, 동일 기준으로 품질·성능 지표를 다시 측정해 IRIS 보고서에 반영.

---

## 6. 참고 문서·링크

- IRIS 연구계획서 PART3 (출력·품질 평가)
  - `@pdf/ocr/과제접수연구개발계획서(PART3(본문2))_ocr.pdf`
- 내부 설계
  - `render_pipeline.py`
  - QC 체크리스트 초안 문서 (원본 노트의 경로 참고).

> 메모: 이 노트는 2024-10-14 원본 연구노트의 출력·QC 관련 내용을 책임자 관점에서 구조화한 기록으로, 이후 IRIS 리허설과 최종보고서의 품질 지표 챕터에 직접 연결될 예정이다.