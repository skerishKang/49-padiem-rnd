# 연구노트 (책임자 관점)

- **날짜**: 2024-10-28
- **작성자**: 강혜림
- **역할**: 책임연구원
- **진행 단계**: 1단계 기초연구·설계
- **아젠다**: 다국어 리소스 로딩 최적화, 번들 경량화, CDN 캐시 전략

---

## 1. 연구 배경·목적 정리 (책임 관점)

- 콘솔 UI에 6개 언어(ko/en/ja/zh/es/fr)를 지원하면서 초기 로딩 시간이 길어지는 문제가 발생.
- 목표는
  - IRIS 제출 전 콘솔 접속 시 "체감 대기 시간"을 3초 이내로 줄이고,
  - 다국어 리소스를 효율적으로 캐시해, 재방문 시에는 거의 즉시 화면이 열리도록 하는 것.

---

## 2. 오늘 진행 내용 (세부)

### 2.1 번들 분석
- `webpack-bundle-analyzer`와 Edge 캐시 로그를 활용해 번들 크기를 분석.
- 평균 번들 크기 약 9.7MB, 일본어/중국어 리소스가 11MB까지 커진 구간을 확인.
- STT 프롬프트 템플릿, 자막 glossary 등 중복된 JSON 항목 267건을 식별.

### 2.2 매니페스트 구조 재설계
- 언어 공통 모듈(날짜/시간/에러 메시지 등)과 언어 전용 모듈(레이블/도움말)을 분리.
- 2단계 manifest 구조를 도입해, 최초 로딩 시 공통 모듈만 불러오고, 언어 전용 리소스는 필요 시 로딩하도록 설계.
- 번들 파일명에 SHA-256 해시를 포함해 캐시 무결성 검증을 자동화.

### 2.3 스트리밍 캐시 로더 구현
- `prefetch` + `stale-while-revalidate` 전략을 적용.
  - 최초 진입 시 핵심 40% 텍스트 리소스만 우선 로드.
  - 나머지 리소스는 백그라운드에서 비동기 로딩.
- GPU 연계 기능(프롬프트 템플릿 등)은 미리 BERT 기반 임베딩을 생성해 캐시에 상주시켜, 이후 호출 시 응답 속도를 개선.

### 2.4 다지역 성능 테스트
- 사내 VPN 3개 리전(서울/도쿄/프랑크푸르트)과 주요 브라우저(Chrome/Edge/Safari)에서 성능 측정.
- FCP(First Contentful Paint), LCP(Largest Contentful Paint), CLS(Cumulative Layout Shift)를 로그로 수집.

---

## 3. 책임자 관점 의사결정·리스크

- **결정 1: CDN·에지 캐시 적극 활용**
  - IRIS 제출 직전에도 콘솔을 많이 열어볼 것이므로, 다국어 리소스를 CDN·에지에 적극적으로 캐시하는 전략을 채택.

- **리스크 1: 모바일 Safari의 Service Worker 동작 이슈**
  - 일부 iOS 16 기기에서 Service Worker 업데이트가 지연되어 이전 리소스를 계속 사용하는 문제가 발견.
  - → **대응**: `skipWaiting` 전략을 검토하고, 10/29 빌드에서 반영 예정.

- **리스크 2: 중국 구간 네트워크 품질**
  - 중국 지역에서 CDN 경로가 불안정한 구간 확인.
  - → **대응**: 11월 초까지 별도 Edge/미러 구성 계획 수립.

---

## 4. 지표·산출물 정리

- **성능 지표**
  - FCP: 4.8초 → 2.7초.
  - LCP: 3.4초 → 2.1초.
  - CLS: 0.14 → 0.09.
  - CDN 적중률: 58% → 83%.
- **문서**
  - `docs/perf/multilang_cdn_plan_v3.md` 업데이트.

---

## 5. 다음 액션 (책임 관점 To-do)

1. **10/29 IRIS 문서 교정 및 번역 QA와 연계**
   - 다국어 리소스 구조 변경 사항을 IRIS 문서/체크리스트에도 반영.

2. **11월 초 중국 대상 CDN/Edge 구성 검토**
   - IRIS 평가 환경을 고려해, 중국 구간 네트워크 이슈를 완화할 수 있는 방안 설계.

---

## 6. 참고 문서·링크

- Addy Osmani, Optimizing JavaScript Bundle Loading, 2024.
- `data/logs/20241028_cdn_perf.csv` (성능 로그).

> 메모: 이 노트는 2024-10-28 원본 연구노트의 다국어 번들 최적화 내용을 책임자 관점에서 정리한 것이다. IRIS 제출 전 콘솔 응답성 개선의 핵심 근거로 사용된다.