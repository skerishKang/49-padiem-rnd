# 연구노트 (책임자 관점)

- **날짜**: 2024-11-20
- **작성자**: 강혜림
- **역할**: 책임연구원
- **진행 단계**: 2단계 서비스·운영 통합 검증 (인프라 안정화)
- **아젠다**: KMS 쿼터 상향, 로그 압축·보관 정책, SLA 모니터링 규칙 정비

---

## 1. 연구 배경·목적 (책임 관점)

- 자동 저장·암호화 도입 이후 KMS 호출량 증가와 로그 파일 증가로 인해 **장기 운영 리스크**가 보이기 시작.
- 목표는
  - KMS 쿼터를 안전한 수준으로 상향 조정하고,
  - 로그 저장·복구 전략을 명확히 하며,
  - SLO/SLA 모니터링 규칙을 체계적으로 정리하는 것.

---

## 2. 오늘 주요 진행 내용

### 2.1 KMS 쿼터 상향
- Azure 지원팀과 협의해 KeyOperation QPS를 초당 20 → 80으로 상향.
- 사용 패턴을 분석해 피크 시간대(13시, 22시)를 기준으로 알림·스케일링 정책을 보완.

### 2.2 로그 압축·보관 정책 수립
- 콘솔·업로드·KMS 관련 로그를 하루 단위 gzip 압축.
- 30일간 온라인 보관 후, 장기 보관은 Glacier 계열로 이동.
- Airflow에 log-rotate 작업을 추가해 Kibana 인덱스도 함께 정리.

### 2.3 SLO/SLA 모니터링
- SLO 정의:
  - 업로드 성공률 99%
  - 평균 응답 10초 이내
- Alertmanager에 SLO 위반 시 경보 규칙 추가.
- SLA 보고용 패널을 Grafana에 추가, 주간 보고에 활용 가능하도록 정리.

---

## 3. 책임자 관점 의사결정·리스크

- **결정**: KMS 관련 장애는 "중요도 High"로 분류, IRIS 제출 기간에는 24/7 대응 체계 유지.
- **리스크**:
  - 로그 압축 이후 복구 시간이 늘어날 수 있음 → 최근 3일 로그는 압축 예외로 두고, 나머지에만 적용.

---

## 4. 산출물·지표

- KMS 호출 실패율: 0.8% → 0%.
- 일일 로그 용량: 6GB → 1.8GB.
- 경보 대응 시간: 평균 3분 내.

---

## 5. 다음 액션 (책임 관점)

1. 11/21: D-1 안정화 계획 점검·change freeze 적용.
2. 11/22: Safari·포커스 스타일·로그 복구 정책 보완.

---

## 6. 참고 자료

- `docs/operations/kms_log_policy_v1.0.md`
- Azure Key Vault Scaling Guidance, SLO Engineering Workbook.
